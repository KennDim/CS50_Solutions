<!DOCTYPE html>
<html>
  <head>
    <meta charset="utf-8">
    <title>Credit</title>
  </head>
  <body>
    <div class="output"></div>

    <script type="text/javascript">

      let stringNumber;

      function sumEveryOtherDigits(number) {
        //Returns sum of the digits of the doubled results of
        // every other cardnumber from the penultimate

        let secondLastDigit, sumOfSecondLastDigit = 0;

        for (let i = number.length - 2; i >= 0; i -= 2) {
          secondLastDigit = parseInt(number[i]) * 2; // doubled result (every other times 2)

          if (secondLastDigit < 10) {
            sumOfSecondLastDigit += secondLastDigit;
          }
          else {
            let last = secondLastDigit % 10;
            let first = parseInt(secondLastDigit / 10);
            sumOfSecondLastDigit += last;
            sumOfSecondLastDigit += first;
          }

        }

        return sumOfSecondLastDigit;
      }

      function sumLastDigits(number) {
        //Returns the total sum of the digits that were not doubled and the
        // return of sumEveryOtherDigits

        let totalSum = sumEveryOtherDigits(number);

        for (let i = number.length - 1; i > 0; i -= 2) {
          totalSum += parseInt(number[i]);
        }

        return totalSum;

      }

      function isCongruetToZero(totalSum) {
        // checks if the last digit of the total sum is zero

        if (totalSum % 10 === 0) {
          return true;
        }
        else {
          return false;
        }

      }


      let number;
      do {
        number = prompt("Number");
        //numberCopy = parseInt(number);
      } while (isNaN(number));

      let digitCount = number.length;
      let isNumberValid = isCongruetToZero(sumLastDigits(number));
      const output = document.querySelector(".output");

      if (number[0] == 4 &&
          (digitCount === 13 || digitCount === 16) &&
            isNumberValid) {
        output.textContent = "VISA";
      }
      else if (number[0] == 3 &&
                (number[1] == 4 || number[1] == 7) &&
                  (digitCount === 15) &&
                    isNumberValid) {
        output.textContent = "AMEX";
      }
      else if (number[0] == 5 &&
                (number[1] == 1 || number[1] == 2 || number[1] == 3 || number[1] == 4 || number[1] == 5) &&
                  (digitCount === 16) &&
                    isNumberValid) {
        output.textContent = "MASTERCARD";
      }
      else {
        output.textContent = "INVALID";
      }

    </script>
  </body>
</html>
